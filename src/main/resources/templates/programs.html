<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<head>
    <title th:text="${pageTitle}">í”„ë¡œê·¸ë¨ ì „ì²´ë³´ê¸°</title>
    <style>
        /* í˜ì´ì§€ ì»¨í…Œì´ë„ˆ */
        .programs-page {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* í˜ì´ì§€ í—¤ë” */
        .programs-header {
            margin-bottom: 40px;
        }

        .programs-header h1 {
            font-size: 32px;
            font-weight: 700;
            color: #2C5F5D;
            margin-bottom: 10px;
        }

        .programs-header p {
            font-size: 16px;
            color: #666;
        }

        /* ê²€ìƒ‰ ë° í•„í„° ì„¹ì…˜ */
        .search-filter-section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 40px;
        }

        .search-bar {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
        }

        .search-input {
            flex: 1;
            padding: 14px 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 15px;
        }

        .search-input:focus {
            outline: none;
            border-color: #2C5F5D;
        }

        .search-button {
            padding: 14px 32px;
            background: #2C5F5D;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .search-button:hover {
            background: #1f4543;
        }

        /* í•„í„° ê·¸ë£¹ */
        .filter-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .filter-group {
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        .filter-button {
            width: 100%;
            min-width: 200px;
            padding: 12px 20px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .filter-button:hover {
            border-color: #2C5F5D;
            background: #f8fafa;
        }

        .filter-button i {
            transition: transform 0.3s ease;
        }

        .filter-menu {
            position: absolute;
            top: calc(100% + 8px);
            left: 0;
            width: 100%;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: none;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
        }

        .filter-menu.active {
            display: block;
        }

        .filter-menu-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .filter-menu-item:hover {
            background: #f8fafa;
        }

        .filter-menu-item.selected {
            background: #e8f5f1;
            color: #2C5F5D;
            font-weight: 500;
        }

        /* ê²°ê³¼ ì •ë³´ */
        .programs-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 2px solid #2C5F5D;
        }

        .programs-count {
            font-size: 16px;
            color: #333;
        }

        .programs-count strong {
            color: #2C5F5D;
            font-size: 18px;
        }

        .reset-filters {
            padding: 8px 16px;
            background: #f5f5f5;
            color: #666;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-filters:hover {
            background: #e8e8e8;
            border-color: #999;
        }

        /* í”„ë¡œê·¸ë¨ ê·¸ë¦¬ë“œ */
        .programs-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
        }

        /* ìƒíƒœ ë²”ë¡€ */
        .status-legend {
            background: #f8f9fa;
            padding: 16px 24px;
            border-radius: 8px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 24px;
            font-size: 14px;
        }

        .status-legend-title {
            font-weight: 600;
            color: #495057;
            margin-right: 8px;
        }

        .status-legend-items {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .status-legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-legend-badge {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            color: white;
        }

        .status-legend-badge.green {
            background: #36B37E;
        }

        .status-legend-badge.urgent {
            background: #8B5CF6;
        }

        .status-legend-badge.blue {
            background: #0052CC;
        }

        .status-legend-badge.closed {
            background: #6B7280;
        }

        .status-legend-desc {
            color: #6c757d;
        }

        /* í”„ë¡œê·¸ë¨ ì¹´ë“œ (index.htmlê³¼ ë™ì¼í•œ ìŠ¤íƒ€ì¼) */
        .program-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .program-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }

        .program-image {
            height: 180px;
            position: relative;
            overflow: hidden;
            background: #e9ecef;
        }

        .program-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .program-dday {
            position: absolute;
            top: 12px;
            left: 12px;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 700;
            color: white;
        }

        .program-dday.urgent { background: #ff4444; }
        .program-dday.blue { background: #4285f4; }
        .program-dday.green { background: #34a853; }
        .program-dday.closed { background: #999; }

        .program-favorite {
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 20px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .program-favorite:hover {
            transform: scale(1.2);
        }

        .program-hits {
            position: absolute;
            bottom: 12px;
            right: 12px;
            padding: 4px 10px;
            background: rgba(0,0,0,0.3);
            color: white;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        .program-icon {
            font-size: 48px;
        }

        .program-content {
            padding: 20px;
        }

        .program-department {
            font-size: 12px;
            color: #2C5F5D;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .program-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 8px;
            line-height: 1.4;
            min-height: 44px;
        }

        .program-title a {
            color: #333;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .program-title a:hover {
            color: #2C5F5D;
            text-decoration: underline;
        }

        .program-category {
            font-size: 12px;
            color: #666;
            margin-bottom: 12px;
        }

        .program-dates {
            font-size: 12px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .program-progress {
            margin-top: 12px;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .progress-bar {
            height: 100%;
            background: #2C5F5D;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 12px;
            color: #666;
            text-align: right;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 80px 20px;
        }

        .empty-state i {
            font-size: 64px;
            color: #ddd;
            margin-bottom: 20px;
        }

        .empty-state h3 {
            font-size: 20px;
            color: #666;
            margin-bottom: 10px;
        }

        .empty-state p {
            font-size: 14px;
            color: #999;
        }

        /* í˜ì´ì§€ë„¤ì´ì…˜ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 48px;
            padding: 24px 0;
        }

        .pagination-button {
            min-width: 40px;
            height: 40px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            background: white;
            color: #666;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pagination-button:hover:not(:disabled):not(.active) {
            border-color: #2C5F5D;
            color: #2C5F5D;
            background: #f8fafa;
        }

        .pagination-button.active {
            background: #2C5F5D;
            color: white;
            border-color: #2C5F5D;
            cursor: default;
        }

        .pagination-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-button.prev,
        .pagination-button.next {
            padding: 8px 16px;
        }

        .pagination-info {
            font-size: 14px;
            color: #666;
            margin: 0 16px;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 1200px) {
            .programs-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (max-width: 768px) {
            .programs-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 16px;
            }

            .filter-row {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .programs-grid {
                grid-template-columns: 1fr;
            }

            .programs-header h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div layout:fragment="content" class="programs-page">
        <!-- í˜ì´ì§€ í—¤ë” -->
        <div class="programs-header">
            <h1>í”„ë¡œê·¸ë¨ ì „ì²´ë³´ê¸°</h1>
            <p>í‘¸ë¦„ëŒ€í•™êµ í•™ìƒì„±ì¥ì§€ì›ì„¼í„°ì˜ ëª¨ë“  í”„ë¡œê·¸ë¨ì„ í™•ì¸í•˜ì„¸ìš”</p>
        </div>

        <!-- ê²€ìƒ‰ ë° í•„í„° ì„¹ì…˜ -->
        <div class="search-filter-section">
            <!-- ê²€ìƒ‰ë°” -->
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="í”„ë¡œê·¸ë¨ ì œëª©ìœ¼ë¡œ ê²€ìƒ‰í•˜ì„¸ìš”..."
                       th:value="${searchKeyword}" id="searchInput">
                <button class="search-button" onclick="performSearch()">
                    <i class="fas fa-search"></i> ê²€ìƒ‰
                </button>
            </div>

            <!-- í•„í„° -->
            <div class="filter-row">
                <!-- í–‰ì •ë¶€ì„œ í•„í„° -->
                <div class="filter-group">
                    <button class="filter-button" onclick="toggleFilter('department')">
                        <span>
                            <i class="fas fa-building"></i>
                            <span id="department-label" th:text="${selectedDepartment != null ? selectedDepartment : 'ì „ì²´ í–‰ì •ë¶€ì„œ'}">ì „ì²´ í–‰ì •ë¶€ì„œ</span>
                        </span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-menu" id="department-menu">
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == null ? 'selected' : ''}" onclick="selectFilter('department', '')">ì „ì²´</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'êµìˆ˜í•™ìŠµì§€ì›ì„¼í„°' ? 'selected' : ''}" onclick="selectFilter('department', 'êµìˆ˜í•™ìŠµì§€ì›ì„¼í„°')">êµìˆ˜í•™ìŠµì§€ì›ì„¼í„°</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'ë„ì„œê´€' ? 'selected' : ''}" onclick="selectFilter('department', 'ë„ì„œê´€')">ë„ì„œê´€</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'ìƒí™œê´€' ? 'selected' : ''}" onclick="selectFilter('department', 'ìƒí™œê´€')">ìƒí™œê´€</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'í•™ìƒìƒë‹´ì„¼í„°' ? 'selected' : ''}" onclick="selectFilter('department', 'í•™ìƒìƒë‹´ì„¼í„°')">í•™ìƒìƒë‹´ì„¼í„°</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'ì¥ì• í•™ìƒì§€ì›ì„¼í„°' ? 'selected' : ''}" onclick="selectFilter('department', 'ì¥ì• í•™ìƒì§€ì›ì„¼í„°')">ì¥ì• í•™ìƒì§€ì›ì„¼í„°</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'ì·¨ì°½ì—…ì§€ì›ì„¼í„°' ? 'selected' : ''}" onclick="selectFilter('department', 'ì·¨ì°½ì—…ì§€ì›ì„¼í„°')">ì·¨ì°½ì—…ì§€ì›ì„¼í„°</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'í‰ìƒêµìœ¡ì›' ? 'selected' : ''}" onclick="selectFilter('department', 'í‰ìƒêµìœ¡ì›')">í‰ìƒêµìœ¡ì›</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'í•™ìƒì²˜' ? 'selected' : ''}" onclick="selectFilter('department', 'í•™ìƒì²˜')">í•™ìƒì²˜</div>
                        <div class="filter-menu-item" th:classappend="${selectedDepartment == 'í•™ìŠµì—­ëŸ‰ê°•í™”ì‚¬ì—…ë‹¨' ? 'selected' : ''}" onclick="selectFilter('department', 'í•™ìŠµì—­ëŸ‰ê°•í™”ì‚¬ì—…ë‹¨')">í•™ìŠµì—­ëŸ‰ê°•í™”ì‚¬ì—…ë‹¨</div>
                    </div>
                </div>

                <!-- ë‹¨ê³¼ëŒ€í•™ í•„í„° -->
                <div class="filter-group">
                    <button class="filter-button" onclick="toggleFilter('college')">
                        <span>
                            <i class="fas fa-university"></i>
                            <span id="college-label" th:text="${selectedCollege != null ? selectedCollege : 'ì „ì²´ ë‹¨ê³¼ëŒ€í•™'}">ì „ì²´ ë‹¨ê³¼ëŒ€í•™</span>
                        </span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-menu" id="college-menu">
                        <div class="filter-menu-item" th:classappend="${selectedCollege == null ? 'selected' : ''}" onclick="selectFilter('college', '')">ì „ì²´</div>
                        <div class="filter-menu-item" th:classappend="${selectedCollege == 'RISEì‚¬ì—…ë‹¨' ? 'selected' : ''}" onclick="selectFilter('college', 'RISEì‚¬ì—…ë‹¨')">RISEì‚¬ì—…ë‹¨</div>
                        <div class="filter-menu-item" th:classappend="${selectedCollege == 'RISì§€ì›ì„¼í„°' ? 'selected' : ''}" onclick="selectFilter('college', 'RISì§€ì›ì„¼í„°')">RISì§€ì›ì„¼í„°</div>
                        <div class="filter-menu-item" th:classappend="${selectedCollege == 'ê°„í˜¸ëŒ€í•™' ? 'selected' : ''}" onclick="selectFilter('college', 'ê°„í˜¸ëŒ€í•™')">ê°„í˜¸ëŒ€í•™</div>
                        <div class="filter-menu-item" th:classappend="${selectedCollege == 'êµìœ¡ëŒ€í•™ì›' ? 'selected' : ''}" onclick="selectFilter('college', 'êµìœ¡ëŒ€í•™ì›')">êµìœ¡ëŒ€í•™ì›</div>
                        <div class="filter-menu-item" th:classappend="${selectedCollege == 'ê¸°ê³„ICTìœµí•©ê³µí•™ë¶€' ? 'selected' : ''}" onclick="selectFilter('college', 'ê¸°ê³„ICTìœµí•©ê³µí•™ë¶€')">ê¸°ê³„ICTìœµí•©ê³µí•™ë¶€</div>
                        <div class="filter-menu-item" th:classappend="${selectedCollege == 'ì•½í•™ëŒ€í•™' ? 'selected' : ''}" onclick="selectFilter('college', 'ì•½í•™ëŒ€í•™')">ì•½í•™ëŒ€í•™</div>
                    </div>
                </div>

                <!-- 1ì°¨ë¶„ë¥˜ í•„í„° -->
                <div class="filter-group">
                    <button class="filter-button" onclick="toggleFilter('category')">
                        <span>
                            <i class="fas fa-tags"></i>
                            <span id="category-label" th:text="${selectedCategory != null ? selectedCategory : 'ì „ì²´ 1ì°¨ë¶„ë¥˜'}">ì „ì²´ 1ì°¨ë¶„ë¥˜</span>
                        </span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="filter-menu" id="category-menu">
                        <div class="filter-menu-item" th:classappend="${selectedCategory == null ? 'selected' : ''}" onclick="selectFilter('category', '')">ì „ì²´</div>
                        <div class="filter-menu-item" th:classappend="${selectedCategory == 'í•™ìŠµì—­ëŸ‰' ? 'selected' : ''}" onclick="selectFilter('category', 'í•™ìŠµì—­ëŸ‰')">í•™ìŠµì—­ëŸ‰</div>
                        <div class="filter-menu-item" th:classappend="${selectedCategory == 'ì§„ë¡œì§€ë„' ? 'selected' : ''}" onclick="selectFilter('category', 'ì§„ë¡œì§€ë„')">ì§„ë¡œì§€ë„</div>
                        <div class="filter-menu-item" th:classappend="${selectedCategory == 'ì‹¬ë¦¬ìƒë‹´' ? 'selected' : ''}" onclick="selectFilter('category', 'ì‹¬ë¦¬ìƒë‹´')">ì‹¬ë¦¬ìƒë‹´</div>
                        <div class="filter-menu-item" th:classappend="${selectedCategory == 'ì¥ì• í•™ìƒì§€ì›' ? 'selected' : ''}" onclick="selectFilter('category', 'ì¥ì• í•™ìƒì§€ì›')">ì¥ì• í•™ìƒì§€ì›</div>
                        <div class="filter-menu-item" th:classappend="${selectedCategory == 'ê¸°íƒ€' ? 'selected' : ''}" onclick="selectFilter('category', 'ê¸°íƒ€')">ê¸°íƒ€</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìƒíƒœ ë²”ë¡€ -->
        <div class="status-legend">
            <div class="status-legend-title">ğŸ“Œ ì‹ ì²­ ìƒíƒœ ì•ˆë‚´</div>
            <div class="status-legend-items">
                <div class="status-legend-item">
                    <span class="status-legend-badge blue">ì ‘ìˆ˜ì˜ˆì •</span>
                    <span class="status-legend-desc">ì‹ ì²­ ì‹œì‘ ì „</span>
                </div>
                <div class="status-legend-item">
                    <span class="status-legend-badge green">ì ‘ìˆ˜ì¤‘</span>
                    <span class="status-legend-desc">ì‹ ì²­ ê°€ëŠ¥ (ì—¬ìœ )</span>
                </div>
                <div class="status-legend-item">
                    <span class="status-legend-badge urgent">ë§ˆê°ì„ë°•</span>
                    <span class="status-legend-desc">7ì¼ ì´ë‚´ ë§ˆê°</span>
                </div>
                <div class="status-legend-item">
                    <span class="status-legend-badge closed">ë§ˆê°</span>
                    <span class="status-legend-desc">ì‹ ì²­ ì¢…ë£Œ</span>
                </div>
                <div class="status-legend-item">
                    <span class="status-legend-badge closed">ì •ì›ë§ˆê°</span>
                    <span class="status-legend-desc">ì¸ì› ì´ˆê³¼</span>
                </div>
            </div>
        </div>

        <!-- ê²°ê³¼ ì •ë³´ -->
        <div class="programs-info">
            <div class="programs-count">
                ì´ <strong th:text="${programs.size()}">0</strong>ê°œì˜ í”„ë¡œê·¸ë¨ì´ ìˆìŠµë‹ˆë‹¤
            </div>
            <button class="reset-filters" onclick="resetFilters()">
                <i class="fas fa-redo"></i> í•„í„° ì´ˆê¸°í™”
            </button>
        </div>

        <!-- í”„ë¡œê·¸ë¨ ê·¸ë¦¬ë“œ -->
        <div class="programs-grid" th:if="${programs.size() > 0}">
            <div th:each="program, iterStat : ${programs}" class="program-card">
                <!-- í”„ë¡œê·¸ë¨ ì´ë¯¸ì§€ -->
                <div class="program-image">
                    <img th:src="'https://picsum.photos/seed/' + ${program.programId} + '/360/180'"
                         th:alt="${program.title}"
                         loading="lazy">

                    <!-- ìƒíƒœ ë°°ì§€ -->
                    <!-- ì‹ ì²­ ë§ˆê° -->
                    <div th:if="${program.status.name() == 'CLOSED'}" class="program-dday closed">ë§ˆê°</div>
                    <!-- ì‹ ì²­ ì˜ˆì • -->
                    <div th:if="${program.status.name() == 'SCHEDULED'}" class="program-dday blue">ì ‘ìˆ˜ì˜ˆì •</div>
                    <!-- ì‹ ì²­ ì¤‘ - ë§ˆê°ì„ë°• (7ì¼ ì´ë‚´) -->
                    <div th:if="${program.status.name() == 'OPEN' && program.dDay != null && program.dDay <= 7}"
                         class="program-dday urgent">ë§ˆê°ì„ë°•</div>
                    <!-- ì‹ ì²­ ì¤‘ - ì ‘ìˆ˜ì¤‘ (7ì¼ ì´ˆê³¼) -->
                    <div th:if="${program.status.name() == 'OPEN' && program.dDay != null && program.dDay > 7}"
                         class="program-dday green">ì ‘ìˆ˜ì¤‘</div>
                    <!-- ê¸°íƒ€ ìƒíƒœ -->
                    <div th:if="${program.status.name() == 'OPEN' && program.dDay == null}" class="program-dday closed">ë§ˆê°</div>
                    <div th:if="${program.status.name() == 'FULL'}" class="program-dday closed">ì •ì›ë§ˆê°</div>

                    <div class="program-favorite">â­</div>
                    <div class="program-hits"><span th:text="${program.hits}"></span> HITS</div>
                </div>
                <div class="program-content">
                    <div class="program-department" th:text="${program.department}"></div>
                    <div class="program-title">
                        <a th:href="@{/programs/{id}(id=${program.programId})}" th:text="${program.title}"></a>
                    </div>
                    <div class="program-category" th:text="${program.subCategory != null ? program.subCategory : program.category}"></div>
                    <div class="program-dates">
                        <span th:text="'ğŸ“… ì‹ ì²­: ' + ${#temporals.format(program.applicationStartDate, 'yyyy.MM.dd(E)')} + ' ~ ' + ${#temporals.format(program.applicationEndDate, 'yyyy.MM.dd(E)')}"></span><br>
                        <span th:if="${program.content != null}"
                              th:text="'â° ìš´ì˜: ' + ${#temporals.format(program.applicationStartDate, 'yyyy.MM.dd(E)')} + ' ~ ' + ${#temporals.format(program.applicationEndDate, 'yyyy.MM.dd(E)')}"></span>
                    </div>
                    <div class="program-progress">
                        <div class="progress-bar-container">
                            <div class="progress-bar" th:style="'width: ' + ${program.participationRate} + '%;'"></div>
                        </div>
                        <div class="progress-text">
                            <span th:text="${program.currentParticipants}"></span>/<span th:if="${program.maxParticipants != null}" th:text="${program.maxParticipants} + 'ëª…'"></span><span th:if="${program.maxParticipants == null}">ë¬´ì œí•œ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" th:if="${programs.size() == 0}">
            <i class="fas fa-inbox"></i>
            <h3>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h3>
            <p>ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë‚˜ í•„í„°ë¥¼ ì‹œë„í•´ë³´ì„¸ìš”</p>
        </div>

        <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div class="pagination" th:if="${totalPages > 0}">
            <!-- ì´ì „ ë²„íŠ¼ -->
            <button class="pagination-button prev"
                    th:disabled="${currentPage == 0}"
                    onclick="goToPage([[${currentPage - 1}]])">
                <i class="fas fa-chevron-left"></i> ì´ì „
            </button>

            <!-- í˜ì´ì§€ ë²ˆí˜¸ -->
            <th:block th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
                <!-- 7í˜ì´ì§€ ì´í•˜: ëª¨ë“  í˜ì´ì§€ í‘œì‹œ -->
                <button th:if="${totalPages <= 7}"
                        class="pagination-button"
                        th:classappend="${i == currentPage ? 'active' : ''}"
                        th:text="${i + 1}"
                        th:onclick="'goToPage(' + ${i} + ')'">
                </button>

                <!-- 7í˜ì´ì§€ ì´ˆê³¼: ìŠ¤ë§ˆíŠ¸ í˜ì´ì§€ í‘œì‹œ -->
                <th:block th:if="${totalPages > 7}">
                    <!-- ì²« 2í˜ì´ì§€ -->
                    <button th:if="${i < 2}"
                            class="pagination-button"
                            th:classappend="${i == currentPage ? 'active' : ''}"
                            th:text="${i + 1}"
                            th:onclick="'goToPage(' + ${i} + ')'">
                    </button>

                    <!-- ... (ì•ìª½ ìƒëµ í‘œì‹œ) -->
                    <span th:if="${i == 2 && currentPage > 3}" class="pagination-info">...</span>

                    <!-- í˜„ì¬ í˜ì´ì§€ ì£¼ë³€ (currentPage-1, currentPage, currentPage+1) -->
                    <button th:if="${i >= 2 && i < totalPages - 2 && i >= currentPage - 1 && i <= currentPage + 1}"
                            class="pagination-button"
                            th:classappend="${i == currentPage ? 'active' : ''}"
                            th:text="${i + 1}"
                            th:onclick="'goToPage(' + ${i} + ')'">
                    </button>

                    <!-- ... (ë’¤ìª½ ìƒëµ í‘œì‹œ) -->
                    <span th:if="${i == totalPages - 3 && currentPage < totalPages - 4}" class="pagination-info">...</span>

                    <!-- ë§ˆì§€ë§‰ 2í˜ì´ì§€ -->
                    <button th:if="${i >= totalPages - 2}"
                            class="pagination-button"
                            th:classappend="${i == currentPage ? 'active' : ''}"
                            th:text="${i + 1}"
                            th:onclick="'goToPage(' + ${i} + ')'">
                    </button>
                </th:block>
            </th:block>

            <!-- ë‹¤ìŒ ë²„íŠ¼ -->
            <button class="pagination-button next"
                    th:disabled="${currentPage == totalPages - 1}"
                    onclick="goToPage([[${currentPage + 1}]])">
                ë‹¤ìŒ <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <th:block layout:fragment="script">
        <script>
            // í•„í„° í† ê¸€
            function toggleFilter(type) {
                const menu = document.getElementById(type + '-menu');
                const button = menu.previousElementSibling;
                const icon = button.querySelector('.fa-chevron-down');

                // ë‹¤ë¥¸ ë©”ë‰´ ë‹«ê¸°
                document.querySelectorAll('.filter-menu').forEach(m => {
                    if (m !== menu) {
                        m.classList.remove('active');
                        m.previousElementSibling.querySelector('.fa-chevron-down').style.transform = 'rotate(0deg)';
                    }
                });

                // í˜„ì¬ ë©”ë‰´ í† ê¸€
                const isActive = menu.classList.toggle('active');
                icon.style.transform = isActive ? 'rotate(180deg)' : 'rotate(0deg)';
            }

            // í•„í„° ì„ íƒ
            function selectFilter(type, value) {
                const url = new URL(window.location.href);

                // ê²€ìƒ‰ì–´ ì œê±° (í•„í„° ì‚¬ìš© ì‹œ)
                url.searchParams.delete('search');

                if (value) {
                    url.searchParams.set(type, value);
                } else {
                    url.searchParams.delete(type);
                }

                window.location.href = url.toString();
            }

            // ê²€ìƒ‰ ì‹¤í–‰
            function performSearch() {
                const searchInput = document.getElementById('searchInput');
                const searchValue = searchInput.value.trim();

                const url = new URL(window.location.href);

                // í•„í„° ì œê±° (ê²€ìƒ‰ ì‚¬ìš© ì‹œ)
                url.searchParams.delete('department');
                url.searchParams.delete('college');
                url.searchParams.delete('category');

                if (searchValue) {
                    url.searchParams.set('search', searchValue);
                } else {
                    url.searchParams.delete('search');
                }

                window.location.href = url.toString();
            }

            // Enter í‚¤ë¡œ ê²€ìƒ‰
            document.getElementById('searchInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            // í•„í„° ì´ˆê¸°í™”
            function resetFilters() {
                window.location.href = '/programs';
            }

            // í˜ì´ì§€ ì´ë™
            function goToPage(pageNum) {
                const url = new URL(window.location.href);
                url.searchParams.set('page', pageNum);
                window.location.href = url.toString();
            }

            // ì™¸ë¶€ í´ë¦­ ì‹œ ë©”ë‰´ ë‹«ê¸°
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.filter-group')) {
                    document.querySelectorAll('.filter-menu').forEach(menu => {
                        menu.classList.remove('active');
                        menu.previousElementSibling.querySelector('.fa-chevron-down').style.transform = 'rotate(0deg)';
                    });
                }
            });
        </script>
    </th:block>
</body>
</html>
